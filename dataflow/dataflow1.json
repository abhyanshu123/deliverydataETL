{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Sales_SAL_SWINVC_TB",
						"type": "DatasetReference"
					},
					"name": "SalesSALSWINVCTB"
				},
				{
					"dataset": {
						"referenceName": "Teamleader",
						"type": "DatasetReference"
					},
					"name": "Teamleader"
				},
				{
					"dataset": {
						"referenceName": "AfterSalesCRMSCEQRY",
						"type": "DatasetReference"
					},
					"name": "AfterSalesCRMSCEQRY"
				},
				{
					"dataset": {
						"referenceName": "AfterSalesCMMCMCD",
						"type": "DatasetReference"
					},
					"name": "AfterSalesCMMCMCD"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "Transformation"
				},
				{
					"name": "Transformation1"
				},
				{
					"name": "Renaming"
				},
				{
					"name": "Renaming1"
				},
				{
					"name": "join1"
				},
				{
					"name": "Transformation2"
				},
				{
					"name": "select1"
				},
				{
					"name": "CMCDselect"
				},
				{
					"name": "CMCDfilter"
				},
				{
					"name": "lookup1"
				},
				{
					"name": "select2"
				}
			],
			"scriptLines": [
				"source(output(",
				"          INVC_DLR_NO as string,",
				"          INVC_NO as string,",
				"          INVC_CORP_NO as string,",
				"          INVC_CMPN_NO as string,",
				"          INVC_TYPE as string,",
				"          INVC_CNFM_YN as string,",
				"          INVC_CNFM_DATE as string,",
				"          INVC_DATE as string,",
				"          INVC_INSR_YN as string,",
				"          INVC_INSR_AMT as string,",
				"          INVC_INSR_DATE as string,",
				"          INVC_INSR_TYPE as string,",
				"          INVC_INSR_NO as string,",
				"          INVC_RGSTN_NO as string,",
				"          INVC_RGSTN_DATE as string,",
				"          INVC_DLVRY_DATE as string,",
				"          INVC_ADDR1 as string,",
				"          INVC_ADDR2 as string,",
				"          INVC_ADDR3 as string,",
				"          INVC_RGN_CODE as string,",
				"          INVC_STCD_CODE as string,",
				"          INVC_CITY_CODE as string,",
				"          INVC_LCTN_CODE as string,",
				"          INVC_PIN_CODE as string,",
				"          INVC_CNCL_YN as string,",
				"          INVC_CNCL_DATE as string,",
				"          INVC_CNCL_RMRKS as string,",
				"          INVC_BKNG_NO as string,",
				"          INVC_CRTE_DTIME as string,",
				"          INVC_CRTE_EMP_NO as string,",
				"          INVC_UPDT_DTIME as string,",
				"          INVC_UPDT_EMP_NO as string,",
				"          INVC_ACTRL_USR_YN as string,",
				"          INVC_DN_DATE as string,",
				"          INVC_DLVRY_CNFM_YN as string,",
				"          INVC_CC_REQ as string,",
				"          INVC_CC_REASON as string,",
				"          INVC_CC_RDATE as string,",
				"          INVC_CC_RMRKS as string,",
				"          INVC_CC_RA_YN as string,",
				"          INVC_CC_STATUS as string,",
				"          INVC_CC_REQ_VERSION as string,",
				"          INVC_HMIL_EMP_CODE as string,",
				"          INVC_ENQRY_NO as string,",
				"          INVC_REGI_FILE_DOC_NO as string,",
				"          INVC_DLVRY_FILE_DOC_NO as string,",
				"          INVC_REGI_CUST_NO as string,",
				"          INVC_REGI_RELAT_SHIP as string,",
				"          INVC_VIN_NO as string,",
				"          INVC_BASIC_PRCE as string,",
				"          INVC_VRNT_PRCE as string,",
				"          INVC_ADVNC_EMI as string,",
				"          INVC_LOAN_AMT as string,",
				"          INVC_WTYNLTY_CFC_YN as string,",
				"          INVC_EQCR_SEQ as string,",
				"          INVC_ALCN_DATE as string,",
				"          INVC_SCHEME_YN as string,",
				"          INVC_MYKIA as string,",
				"          INVC_MYKIA_REG_DATE as string,",
				"          INVC_MK_VINLINK_DT as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> SalesSALSWINVCTB",
				"source(output(",
				"          TEAM_LEADER as string,",
				"          TEAM_LEADER_JOINING_DATE as string,",
				"          TEAM_LEADER_LEAVE_DATE as string,",
				"          KEC as string,",
				"          KEC_NAME as string,",
				"          KEC_CODE as string,",
				"          KEC_JOIN_DATE as string,",
				"          KEC_LEAVE_DATE as string,",
				"          EQRY_ENQRY_NO as string,",
				"          EQRY_DLR_NO as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Teamleader",
				"source(output(",
				"          EQRY_DLR_NO as string,",
				"          EQRY_ENQRY_NO as string,",
				"          EQRY_CORP_NO as string,",
				"          EQRY_CMPN_NO as string,",
				"          EQRY_DATE as string,",
				"          EQRY_SRC_CODE as string,",
				"          EQRY_STAT as string,",
				"          EQRY_TYPE as string,",
				"          EQRY_TEST_DRVR_DATE as string,",
				"          EQRY_FNCE_YN as string,",
				"          EQRY_FNCER_CODE as string,",
				"          EQRY_LOAN_AMT as string,",
				"          EQRY_TENOR_MNTHS as string,",
				"          EQRY_EXCHG_YN as string,",
				"          EQRY_EXCHG_MODEL_CODE as string,",
				"          EQRY_EXCHG_SRC_CODE as string,",
				"          EQRY_EXPCT_PRICE as string,",
				"          EQRY_QUOTD_PRICE as string,",
				"          EQRY_CLSE_DATE as string,",
				"          EQRY_CLSE_TYPE as string,",
				"          EQRY_CLSE_RMRKS as string,",
				"          EQRY_EMP_NO as string,",
				"          EQRY_CUST_NO as string,",
				"          EQRY_LISTD_CORP as string,",
				"          EQRY_CORP_NAME as string,",
				"          EQRY_RFRL_BY as string,",
				"          EQRY_CRTE_DTIME as string,",
				"          EQRY_CRTE_EMP_NO as string,",
				"          EQRY_UPDT_DTIME as string,",
				"          EQRY_UPDT_EMP_NO as string,",
				"          EQRY_EQFU_SEQ as string,",
				"          EQRY_UPDT_DATE as string,",
				"          EQRY_TEST_DRIVE_YN as string,",
				"          EQRY_SR_NUM as string,",
				"          EQRY_SR_TYPE as string,",
				"          EQRY_FLW_STATUS as string,",
				"          EQRY_ASSOCIATE_ID as string,",
				"          EQRY_RSO_ID as string,",
				"          EQRY_FUEL_TYPE as string,",
				"          EQRY_PRESENT_CAR_YN as string,",
				"          EQRY_MAKER_CODE as string,",
				"          EQRY_TD_VIN as string,",
				"          EQRY_CUST_BLOCK as string,",
				"          EQRY_BULK_SALE as string,",
				"          EQRY_P_MODL_YEAR as string,",
				"          EQRY_CLS_VAL as string,",
				"          EQRY_INCOM_GROUP as string,",
				"          EQRY_REFL_ID as string,",
				"          EQRY_REFL_PUNCH_DLR_NO as string,",
				"          EQRY_PLAN_DATE as string,",
				"          EQRY_ATIVT_NAME_CODE as string,",
				"          EQRY_ATIVT_LOC_CODE as string,",
				"          EQRY_NEWCAR_YN as string,",
				"          EQRY_FCALL_EMP_NO as string,",
				"          EQRY_APNT_DTIME as string,",
				"          VIST_DTIME as string,",
				"          LEAV_DTIME as string,",
				"          EQRY_CTGR_CODE as string,",
				"          EQRY_SUB_SRC_CODE as string,",
				"          EQRY_CLSE_GRP_TYPE as string,",
				"          EQRY_BUDG_TYPE as string,",
				"          EQRY_CERT_TYPE as string,",
				"          EQRY_UC_SC_EMP_NO as string,",
				"          EQRY_TDRIVE_RMRKS as string,",
				"          EQRY_VC_RMRKS as string,",
				"          EQRY_REQ_TYPE as string,",
				"          EQRY_EMAILSEND_YN as string,",
				"          EQRY_SRC_FLG as string,",
				"          EQRY_SR_NUM_REAL as string,",
				"          EQRY_ENG_TYP as string,",
				"          EQRY_TRNSM_TYP as string,",
				"          SOQ_TAG_YN as string,",
				"          EQRY_EVAL_YN as string,",
				"          EQRY_EXCH_DN as string,",
				"          EQRY_FINAL_BP as string,",
				"          EQRY_CAMPGN_NO as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> AfterSalesCRMSCEQRY",
				"source(output(",
				"          CMPN_NO as string,",
				"          CORP_NO as string,",
				"          CMM_GRP_CODE as string,",
				"          CMM_CODE as string,",
				"          CMM_CODE_NAME as string,",
				"          REMARK_1 as string,",
				"          REMARK_2 as string,",
				"          REMARK_3 as string,",
				"          REMARK_4 as string,",
				"          REMARK_5 as string,",
				"          USED_YN as string,",
				"          PRIORITY as string,",
				"          CRTE_EMP_NO as string,",
				"          CRTE_DTIME as string,",
				"          UPDT_EMP_NO as string,",
				"          UPDT_DTIME as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> AfterSalesCMMCMCD",
				"SalesSALSWINVCTB derive(IY = right(INVC_CNFM_DATE,4),",
				"          ID = left(INVC_CNFM_DATE,2),",
				"          IM = substring(INVC_CNFM_DATE,4,2),",
				"          {Invoice_Cofirmation_No.} = toString(toTimestamp(toString(byName('INVC_CNFM_DATE')), 'dd-MM-yyyy') , 'dd/MM/yyyy')\r",
				",",
				"          InvDate = toString(toTimestamp(toString(byName('INVC_DATE')), 'dd-MM-yyyy') , 'dd/MM/yyyy')\r",
				",",
				"          Delivery_Date = toString(toTimestamp(toString(byName('INVC_DLVRY_DATE')), 'dd-MM-yyyy') , 'dd/MM/yyyy')\r",
				",",
				"          INVC_CNFM_DATE = iif(INVC_CNFM_DATE=='23-10-2010', replace(INVC_CNFM_DATE, '23-10-2010', '23-10-2020'), INVC_CNFM_DATE)) ~> Transformation",
				"Teamleader derive(Team_Leader_Name = upper(split(TEAM_LEADER, ';')[2]),",
				"          Team_Leader_Code = (split(TEAM_LEADER, ';')[1]),",
				"          {\"Active/Inactive\"} = upper(split(TEAM_LEADER, ';')[3]),",
				"          KEC =  upper(KEC_NAME)) ~> Transformation1",
				"Transformation select(mapColumn(",
				"          {Dealer_No.} = INVC_DLR_NO,",
				"          {Invoice_No.} = INVC_NO,",
				"          {Corporation_No.} = INVC_CORP_NO,",
				"          {Company_No.} = INVC_CMPN_NO,",
				"          INVC_TYPE,",
				"          INVC_CNFM_YN,",
				"          Inv_Confirm = INVC_CNFM_DATE,",
				"          INVC_DATE,",
				"          INVC_INSR_YN,",
				"          INVC_INSR_AMT,",
				"          INVC_INSR_DATE,",
				"          INVC_INSR_TYPE,",
				"          INVC_INSR_NO,",
				"          INVC_RGSTN_NO,",
				"          INVC_RGSTN_DATE,",
				"          INVC_DLVRY_DATE,",
				"          INVC_ADDR1,",
				"          INVC_ADDR2,",
				"          INVC_ADDR3,",
				"          INVC_RGN_CODE,",
				"          INVC_STCD_CODE,",
				"          INVC_CITY_CODE,",
				"          INVC_LCTN_CODE,",
				"          INVC_PIN_CODE,",
				"          INVC_CNCL_YN,",
				"          INVC_CNCL_DATE,",
				"          INVC_CNCL_RMRKS,",
				"          {Booking_No.} = INVC_BKNG_NO,",
				"          INVC_CRTE_DTIME,",
				"          INVC_CRTE_EMP_NO,",
				"          INVC_UPDT_DTIME,",
				"          INVC_UPDT_EMP_NO,",
				"          INVC_ACTRL_USR_YN,",
				"          INVC_DN_DATE,",
				"          INVC_DLVRY_CNFM_YN,",
				"          INVC_CC_REQ,",
				"          INVC_CC_REASON,",
				"          INVC_CC_RDATE,",
				"          INVC_CC_RMRKS,",
				"          INVC_CC_RA_YN,",
				"          INVC_CC_STATUS,",
				"          INVC_CC_REQ_VERSION,",
				"          INVC_HMIL_EMP_CODE,",
				"          {Link_Enquiry_No.} = INVC_ENQRY_NO,",
				"          INVC_REGI_FILE_DOC_NO,",
				"          INVC_DLVRY_FILE_DOC_NO,",
				"          INVC_REGI_CUST_NO,",
				"          INVC_REGI_RELAT_SHIP,",
				"          VIN = INVC_VIN_NO,",
				"          INVC_BASIC_PRCE,",
				"          INVC_VRNT_PRCE,",
				"          INVC_ADVNC_EMI,",
				"          INVC_LOAN_AMT,",
				"          INVC_WTYNLTY_CFC_YN,",
				"          INVC_EQCR_SEQ,",
				"          INVC_ALCN_DATE,",
				"          INVC_SCHEME_YN,",
				"          INVC_MYKIA,",
				"          INVC_MYKIA_REG_DATE,",
				"          INVC_MK_VINLINK_DT,",
				"          IY,",
				"          ID,",
				"          IM,",
				"          {Invoice_Cofirmation_No.},",
				"          InvDate,",
				"          Delivery_Date",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Renaming",
				"Transformation1 select(mapColumn(",
				"          TEAM_LEADER,",
				"          TEAM_LEADER_JOINING_DATE,",
				"          TEAM_LEADER_LEAVE_DATE,",
				"          KEC_Short_Code = KEC,",
				"          KEC_NAME,",
				"          KEC_Long_Code = KEC_CODE,",
				"          KEC_JOIN_DATE,",
				"          KEC_LEAVE_DATE,",
				"          {Link_Enquiry_No.} = EQRY_ENQRY_NO,",
				"          {Dealer_No.} = EQRY_DLR_NO,",
				"          Team_Leader_Name,",
				"          Team_Leader_Code,",
				"          {\"Active/Inactive\"}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Renaming1",
				"Renaming, Renaming1 join(Renaming@{Dealer_No.} == Renaming1@{Dealer_No.},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"AfterSalesCRMSCEQRY derive({\"Finance/Not Finance\"} = iif(EQRY_FNCE_YN=='Y','Finance','Not-Finance') ) ~> Transformation2",
				"Transformation2 select(mapColumn(",
				"          EQRY_DLR_NO,",
				"          EQRY_ENQRY_NO,",
				"          EQRY_CORP_NO,",
				"          EQRY_CMPN_NO,",
				"          EQRY_DATE,",
				"          EQRY_SRC_CODE,",
				"          EQRY_STAT,",
				"          EQRY_TYPE,",
				"          EQRY_TEST_DRVR_DATE,",
				"          EQRY_FNCE_YN,",
				"          EQRY_FNCER_CODE,",
				"          EQRY_LOAN_AMT,",
				"          EQRY_TENOR_MNTHS,",
				"          EQRY_EXCHG_YN,",
				"          EQRY_EXCHG_MODEL_CODE,",
				"          EQRY_EXCHG_SRC_CODE,",
				"          EQRY_EXPCT_PRICE,",
				"          EQRY_QUOTD_PRICE,",
				"          EQRY_CLSE_DATE,",
				"          EQRY_CLSE_TYPE,",
				"          EQRY_CLSE_RMRKS,",
				"          EQRY_EMP_NO,",
				"          EQRY_CUST_NO,",
				"          EQRY_LISTD_CORP,",
				"          EQRY_CORP_NAME,",
				"          EQRY_RFRL_BY,",
				"          EQRY_CRTE_DTIME,",
				"          EQRY_CRTE_EMP_NO,",
				"          EQRY_UPDT_DTIME,",
				"          EQRY_UPDT_EMP_NO,",
				"          EQRY_EQFU_SEQ,",
				"          EQRY_UPDT_DATE,",
				"          EQRY_TEST_DRIVE_YN,",
				"          EQRY_SR_NUM,",
				"          EQRY_SR_TYPE,",
				"          EQRY_FLW_STATUS,",
				"          EQRY_ASSOCIATE_ID,",
				"          EQRY_RSO_ID,",
				"          EQRY_FUEL_TYPE,",
				"          EQRY_PRESENT_CAR_YN,",
				"          EQRY_MAKER_CODE,",
				"          EQRY_TD_VIN,",
				"          EQRY_CUST_BLOCK,",
				"          EQRY_BULK_SALE,",
				"          EQRY_P_MODL_YEAR,",
				"          EQRY_CLS_VAL,",
				"          EQRY_INCOM_GROUP,",
				"          EQRY_REFL_ID,",
				"          EQRY_REFL_PUNCH_DLR_NO,",
				"          EQRY_PLAN_DATE,",
				"          EQRY_ATIVT_NAME_CODE,",
				"          EQRY_ATIVT_LOC_CODE,",
				"          EQRY_NEWCAR_YN,",
				"          EQRY_FCALL_EMP_NO,",
				"          EQRY_APNT_DTIME,",
				"          VIST_DTIME,",
				"          LEAV_DTIME,",
				"          EQRY_CTGR_CODE,",
				"          EQRY_SUB_SRC_CODE,",
				"          EQRY_CLSE_GRP_TYPE,",
				"          EQRY_BUDG_TYPE,",
				"          EQRY_CERT_TYPE,",
				"          EQRY_UC_SC_EMP_NO,",
				"          EQRY_TDRIVE_RMRKS,",
				"          EQRY_VC_RMRKS,",
				"          EQRY_REQ_TYPE,",
				"          EQRY_EMAILSEND_YN,",
				"          EQRY_SRC_FLG,",
				"          EQRY_SR_NUM_REAL,",
				"          EQRY_ENG_TYP,",
				"          EQRY_TRNSM_TYP,",
				"          SOQ_TAG_YN,",
				"          EQRY_EVAL_YN,",
				"          EQRY_EXCH_DN,",
				"          EQRY_FINAL_BP,",
				"          EQRY_CAMPGN_NO,",
				"          {\"Finance/Not Finance\"}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"AfterSalesCMMCMCD select(mapColumn(",
				"          EQRY_CTGR_CODE = CMM_CODE,",
				"          CMM_CODE_NAME,",
				"          CMM_GRP_CODE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> CMCDselect",
				"CMCDselect filter(CMM_GRP_CODE=='DSO0012') ~> CMCDfilter",
				"select1, CMCDfilter lookup(select1@EQRY_CTGR_CODE == CMCDselect@EQRY_CTGR_CODE,",
				"     multiple: false,",
				"     pickup: 'first',",
				"     asc(CMM_CODE_NAME, true),",
				"     broadcast: 'auto')~> lookup1",
				"lookup1 select(mapColumn(",
				"          EQRY_DLR_NO,",
				"          EQRY_ENQRY_NO,",
				"          EQRY_CORP_NO,",
				"          EQRY_CMPN_NO,",
				"          EQRY_DATE,",
				"          EQRY_SRC_CODE,",
				"          EQRY_STAT,",
				"          EQRY_TYPE,",
				"          EQRY_TEST_DRVR_DATE,",
				"          EQRY_FNCE_YN,",
				"          EQRY_FNCER_CODE,",
				"          EQRY_LOAN_AMT,",
				"          EQRY_TENOR_MNTHS,",
				"          EQRY_EXCHG_YN,",
				"          EQRY_EXCHG_MODEL_CODE,",
				"          EQRY_EXCHG_SRC_CODE,",
				"          EQRY_EXPCT_PRICE,",
				"          EQRY_QUOTD_PRICE,",
				"          EQRY_CLSE_DATE,",
				"          EQRY_CLSE_TYPE,",
				"          EQRY_CLSE_RMRKS,",
				"          EQRY_EMP_NO,",
				"          EQRY_CUST_NO,",
				"          EQRY_LISTD_CORP,",
				"          EQRY_CORP_NAME,",
				"          EQRY_RFRL_BY,",
				"          EQRY_CRTE_DTIME,",
				"          EQRY_CRTE_EMP_NO,",
				"          EQRY_UPDT_DTIME,",
				"          EQRY_UPDT_EMP_NO,",
				"          EQRY_EQFU_SEQ,",
				"          EQRY_UPDT_DATE,",
				"          EQRY_TEST_DRIVE_YN,",
				"          EQRY_SR_NUM,",
				"          EQRY_SR_TYPE,",
				"          EQRY_FLW_STATUS,",
				"          EQRY_ASSOCIATE_ID,",
				"          EQRY_RSO_ID,",
				"          EQRY_FUEL_TYPE,",
				"          EQRY_PRESENT_CAR_YN,",
				"          EQRY_MAKER_CODE,",
				"          EQRY_TD_VIN,",
				"          EQRY_CUST_BLOCK,",
				"          EQRY_BULK_SALE,",
				"          EQRY_P_MODL_YEAR,",
				"          EQRY_CLS_VAL,",
				"          EQRY_INCOM_GROUP,",
				"          EQRY_REFL_ID,",
				"          EQRY_REFL_PUNCH_DLR_NO,",
				"          EQRY_PLAN_DATE,",
				"          EQRY_ATIVT_NAME_CODE,",
				"          EQRY_ATIVT_LOC_CODE,",
				"          EQRY_NEWCAR_YN,",
				"          EQRY_FCALL_EMP_NO,",
				"          EQRY_APNT_DTIME,",
				"          VIST_DTIME,",
				"          LEAV_DTIME,",
				"          EQRY_CTGR_CODE = select1@EQRY_CTGR_CODE,",
				"          EQRY_SUB_SRC_CODE,",
				"          EQRY_CLSE_GRP_TYPE,",
				"          EQRY_BUDG_TYPE,",
				"          EQRY_CERT_TYPE,",
				"          EQRY_UC_SC_EMP_NO,",
				"          EQRY_TDRIVE_RMRKS,",
				"          EQRY_VC_RMRKS,",
				"          EQRY_REQ_TYPE,",
				"          EQRY_EMAILSEND_YN,",
				"          EQRY_SRC_FLG,",
				"          EQRY_SR_NUM_REAL,",
				"          EQRY_ENG_TYP,",
				"          EQRY_TRNSM_TYP,",
				"          SOQ_TAG_YN,",
				"          EQRY_EVAL_YN,",
				"          EQRY_EXCH_DN,",
				"          EQRY_FINAL_BP,",
				"          EQRY_CAMPGN_NO,",
				"          {\"Finance/Not Finance\"},",
				"          EQRY_CTGR_CODE = CMCDselect@EQRY_CTGR_CODE,",
				"          Enquiry_Category_Type = CMM_CODE_NAME,",
				"          CMM_GRP_CODE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2"
			]
		}
	}
}